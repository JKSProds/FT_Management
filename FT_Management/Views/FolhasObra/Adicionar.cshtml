@model FT_Management.Models.FolhaObra

@{
    ViewData["Title"] = "Adicionar Intervenção";
}

<h1>Adicionar Intervenção</h1>
<hr />
<form asp-action="Adicionar">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="nav nav-tabs" id="v-pills-tab" role="tablist" aria-orientation="vertical">
        <a class="nav-item nav-link active" id="v-pills-equipamento-tab" data-toggle="pill" href="#v-pills-equipamento" role="tab" aria-controls="v-pills-equipamento" aria-selected="true">Equipamento</a>
        <a class="nav-item nav-link" id="v-pills-dados-tab" data-toggle="pill" href="#v-pills-dados" role="tab" aria-controls="v-pills-dados" aria-selected="false">Dados</a>
    </div>
    <div class="tab-content" id="v-pills-tabContent">
        <div class="tab-pane fade show active" id="v-pills-equipamento" role="tabpanel" aria-labelledby="v-pills-equipamento-tab">
            <br />
            <div class="row">
                <div class="form-group col-6">
                    <div class="form-group d-none">
                        <label asp-for="EquipamentoServico.IdEquipamento" class="control-label"></label>
                        <input asp-for="EquipamentoServico.IdEquipamento" class="form-control" id="IdEquipamento" />
                        <span asp-validation-for="EquipamentoServico.IdEquipamento" class="text-danger"></span>
                    </div>
                    <div class="form-group ">
                        <label asp-for="EquipamentoServico.NumeroSerieEquipamento" class="control-label"></label>
                        <div class="form-group row">
                            <input asp-for="EquipamentoServico.NumeroSerieEquipamento" class="form-control col-10" id="NumeroSerieEquipamento" />
                            <button type="button" class="btn btn-primary" onclick="ObterEquipamento()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <span asp-validation-for="EquipamentoServico.NumeroSerieEquipamento" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-6">
                    <div class="form-group d-none">
                        <label asp-for="EquipamentoServico.DesignacaoEquipamento" class="control-label"></label>
                        <input asp-for="EquipamentoServico.DesignacaoEquipamento" class="form-control" id="DesignacaoEquipamento" />
                        <span asp-validation-for="EquipamentoServico.DesignacaoEquipamento" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="EquipamentoServico.MarcaEquipamento" class="control-label"></label>
                        <input asp-for="EquipamentoServico.MarcaEquipamento" class="form-control" id="MarcaEquipamento" />
                        <span asp-validation-for="EquipamentoServico.MarcaEquipamento" class="text-danger"></span>
                    </div>
                </div>
                <div class="w-100"></div>
                <div class="form-group col-6">
                    <div class="form-group">
                        <label asp-for="EquipamentoServico.ModeloEquipamento" class="control-label"></label>
                        <input asp-for="EquipamentoServico.ModeloEquipamento" class="form-control" id="ModeloEquipamento" />
                        <span asp-validation-for="EquipamentoServico.ModeloEquipamento" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-6">
                    <div class="form-group">
                        <label asp-for="EstadoEquipamento" class="col-form-label"></label>
                        <select asp-for="EstadoEquipamento" class="form-control">
                            <option>Instalação</option>
                            <option>Garantia</option>
                            <option>Não Garantia</option>
                            <option>Outro</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade show" id="v-pills-dados" role="tabpanel" aria-labelledby="v-pills-dados-tab">
            <br />
            <div class="row">
                <div class="form-group col-6">

                    <div class="form-group d-none">
                        <label asp-for="ClienteServico.IdCliente" class="control-label"></label>
                        <input asp-for="ClienteServico.IdCliente" class="form-control" id="IdCliente" />
                        <span asp-validation-for="ClienteServico.IdCliente" class="text-danger"></span>
                    </div>
                    <div class="form-group d-none">
                        <label asp-for="IdFolhaObra" class="control-label"></label>
                        <input asp-for="IdFolhaObra" class="form-control" id="txtIdFolhaObra" />
                        <span asp-validation-for="IdFolhaObra" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="ClienteServico.NomeCliente" class="control-label"></label>
                        <div class="form-group row">
                            <input asp-for="ClienteServico.NomeCliente" class="form-control col-10" id="NomeCliente" />
                            <button type="button" class="btn btn-primary" onclick="ObterCliente()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <span asp-validation-for="ClienteServico.NomeCliente" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-6">
                    <div class="form-group">
                        <label asp-for="ClienteServico.PessoaContatoCliente" class="control-label"></label>
                        <input asp-for="ClienteServico.PessoaContatoCliente" class="form-control" id="PessoaContactoCliente" />
                        <span asp-validation-for="ClienteServico.PessoaContatoCliente" class="text-danger"></span>
                    </div>
                    <div class="form-group d-none">
                        <label asp-for="ClienteServico.MoradaCliente" class="control-label"></label>
                        <input asp-for="ClienteServico.MoradaCliente" class="form-control" id="MoradaCliente" />
                        <span asp-validation-for="ClienteServico.MoradaCliente" class="text-danger"></span>
                    </div>
                    <div class="form-group d-none">
                        <label asp-for="ClienteServico.EmailCliente" class="control-label"></label>
                        <input asp-for="ClienteServico.EmailCliente" class="form-control" id="EmailCliente" />
                        <span asp-validation-for="ClienteServico.EmailCliente" class="text-danger"></span>
                    </div>
                    <div class="form-group d-none">
                        <label asp-for="ClienteServico.NumeroContribuinteCliente" class="control-label"></label>
                        <input asp-for="ClienteServico.NumeroContribuinteCliente" class="form-control" id="NumeroContribuinteCliente" />
                        <span asp-validation-for="ClienteServico.NumeroContribuinteCliente" class="text-danger"></span>
                    </div>
                </div>
                <div class="w-100"></div>
                <div class="form-group col-12">

                    <div class="form-group">
                        <label asp-for="ReferenciaServico" class="control-label"></label>
                        <input asp-for="ReferenciaServico" class="form-control" />
                        <span asp-validation-for="ReferenciaServico" class="text-danger"></span>
                    </div>
                </div>
                <div class="w-100"></div>
                <div class="form-group col-12">

                    <div class="form-group">
                        <label asp-for="RelatorioServico" class="control-label"></label>
                        @Html.EditorFor(model => model.RelatorioServico, new { htmlAttributes = new { @class = "form-control", @rows = "8" } })
                        <span asp-validation-for="RelatorioServico" class="text-danger"></span>
                    </div>
                </div>
                <div class="w-100"></div>
                <div class="form-group col-12">

                    <div class="form-group">
                        <label asp-for="SituacoesPendentes" class="control-label"></label>
                        @Html.EditorFor(model => model.SituacoesPendentes, new { htmlAttributes = new { @class = "form-control", @rows = "4" } })
                        <span asp-validation-for="SituacoesPendentes" class="text-danger"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="form-group">
        <input type="submit" value="Adicionar" class="btn btn-primary" />
    </div>
</form>


<div>
    <a asp-action="Index">Voltar</a>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

<script>
    function ObterEquipamento() {
        var NumeroSerie = document.getElementById("NumeroSerieEquipamento").value;

        $.ajax({
            url: "/FolhasObra/ObterEquipamento",
            type: "GET",
            data: "NumeroSerieEquipamento=" + NumeroSerie,
            dataType: "json", // type of data you're expecting from response
            success: function (json) {
                console.log(json);
                document.getElementById("DesignacaoEquipamento").value = json.json.designacaoEquipamento;
                document.getElementById("MarcaEquipamento").value = json.json.marcaEquipamento;
                document.getElementById("ModeloEquipamento").value = json.json.modeloEquipamento;
                document.getElementById("IdEquipamento").value = json.json.idEquipamento;
                document.getElementById("NumeroSerie").value = json.json.numeroSerie;
            },
            error: function (error) { }
        });
    }

    function ObterCliente() {
        var NomeCliente = document.getElementById("NomeCliente").value;
        //alert(RefProduto);

        $.ajax({
            url: "/FolhasObra/ObterCliente",
            type: "GET",
            data: "NomeCliente=" + NomeCliente,
            dataType: "json", // type of data you're expecting from response
            success: function (json) {
                console.log(json);
                document.getElementById("IdCliente").value = json.json.idCliente;
                document.getElementById("PessoaContactoCliente").value = json.json.pessoaContatoCliente;
                document.getElementById("MoradaCliente").value = json.json.moradaCliente;
                document.getElementById("EmailCliente").value = json.json.emailCliente;
                document.getElementById("NumeroContribuinteCliente").value = json.json.numeroContribuinteCliente;
                document.getElementById("NomeCliente").value = json.json.nomeCliente;
            },
            error: function (error) { }
        });
    }

</script>